<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	>
<h:head>
</h:head>	
<h:body style="background-image:url('../img/Simple-Design-for-Abstract-Wallpaper.jpg');background-attachment:fixed">
	<h:form>
			<table width="100%" align="center" >
				<tr>
					<td align="center" colspan="2">
						<img src="../img/TheGreanGangRadioText.png" id="logo" 
							style="border-radius:25px" onmouseover="this.src='../img/DSC_8085500331.JPG'" 
							onmouseout="this.src='../img/DSC_8084500331.JPG';" 
							/>
					</td>
				</tr>
				<tr><td>&nbsp;</td></tr>
				<tr>
					<td align="left">
						<p:panel>
							<h:outputText value="#{djController.promptTextHost}"/>
							<h:outputText value="#{djController.hostAddress}"/>
						</p:panel>
					</td>
					<td align="center" rowspan="2">
						<p:pickList id="pickList" value="#{djController.songs}" var="song" itemLabel="#{song}" itemValue="#{song}"							 
							showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains" style="width:500px;"
							removeLabel="add to queue" widgetVar="pickList">
						
							<f:facet name="sourceCaption">WinampPlaylist</f:facet>
							<f:facet name="targetCaption">Directory</f:facet>  
														 
							<p:ajax event="transfer" listener="#{djController.onTransfer}" update="messages"/>  
						</p:pickList>						
					</td>
				</tr>
				<tr>
					<td width="45%" valign="top">
						<p:panel header="Controller" footer="Powered by JSF, Primeface, JavaWinampAPI">
							<table>
								<tr>
									<td>
										<h:graphicImage id="playingImage" value="#{djController.playingImage}" width="80" height="106"></h:graphicImage>
									</td>
									<td>
										<h:outputText id="playingMusic" value="#{djController.playingMusic}" styleClass="playingMusic" style="padding-left:5px"/>
										<BR/>
										<!--
											for class with icon(from jQuery UI) 
											http://jquery-ui.googlecode.com/svn/tags/1.6rc5/tests/static/icons.html
										-->
				                     	<p:selectBooleanButton id="playing" value="#{djController.playing}" onLabel="pause" offLabel="play" onIcon="ui-icon-pause" offIcon="ui-icon-play">  
				            				<p:ajax listener="#{djController.playOrPause}" update="playingMusic,playingImage,stopping"/>  
				        				</p:selectBooleanButton>
				        				<p:selectBooleanButton id="stopping" value="#{djController.stopping}" onLabel="stop" offLabel="stop" onIcon="ui-icon-stop" offIcon="ui-icon-stop">  
				            				<p:ajax listener="#{djController.playerControl('stop')}" update="playingMusic,playingImage,playing"/>  
				        				</p:selectBooleanButton>
										<p:commandButton value="previous" icon="ui-icon-seek-first" action="#{djController.playerControl('previous')}" update="playingMusic" />
										<p:commandButton value="next" icon="ui-icon-seek-end" action="#{djController.playerControl('next')}" update="playingMusic" />										
									</td>
								</tr>
							</table>
						</p:panel>						
					</td>
				</tr>
				<tr>
					<td></td>
					<td align="center">
						<p:inplace id="uploader" editor="true" label="upload more file to Server" style="color:gray">
					    	<p:fileUpload fileUploadListener="#{djController.handleFileUpload}"
		            			mode="advanced" 
		            			multiple="true"
		            			update="messages,pickList"            
		            			allowTypes="/(\.|\/)(mp3|flac)$/" />
	            		</p:inplace>
	            		&nbsp;
	            		<p:commandButton title="reload from main directory" styleClass="refreshDirectory" action="#{djController.refreshDirectory}" update="pickList" icon="ui-icon-refresh" style="width:25px;height:25px;vertical-align:inherit;" />
	            		<p:commandButton styleClass="refreshPickList" update="pickList" style="visibility:hidden" />	            		
					</td>
				</tr>
				<tr><td>&nbsp;</td></tr>
			</table>
			
    		<p:growl id="messages" showDetail="true" escape="false"/>    		
    		<p:socket onMessage="handleRefreshPickList" channel="/refreshPickList" />
	</h:form>
</h:body>
<style type="text/css">

/* panel footer */
.ui-panel-footer {
	font-size: 12px;
	height:10px;
}

/* pickList */
.ui-picklist .ui-picklist-list {
	list-style-type: none;
	margin: 0;
	padding: 10px;
	overflow: auto;
	height: 300px;
	width: 300px;
}

/* pickList filter icon */
.ui-picklist .ui-picklist-filter-container .ui-icon {
	position: absolute;
	top: 10px;
	right: 15px;
}
.ui-picklist-button-add { 
	visibility: hidden; 
}
.ui-picklist-button-add-all {
	visibility: hidden;
}
.ui-picklist-button-remove-all {
	visibility: hidden;
}
</style>
	<script type="text/javascript">
// 		$(document).ready(function(){
// 			$(":button[title*='Add']").css("display","none");
// 			$(":button[title='Remove All']").css("display","none");
// 		});	
		function handleRefreshPickList(status) {
			if("1" == status) {
				$(".refreshPickList").click();
// 				Primefaces.ab({source:'',update:''});	
			}
		}
	</script>
</html>